<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact Us - ElectroFix</title>
    <link rel="stylesheet" href="../css/contact.css" />
    <link rel="stylesheet" href="../css/header.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
  </head>
  <body>
    <header class="header">
      <div class="logo"><img src="../images/logo.png" alt="" /></div>
      <nav class="nav" id="main-nav">
        <div class="user-info-mobile">
          <p id="user-name-display"></p>
          <small id="user-address-display"></small>
        </div>

        <div class="nav-mobile-options">
          <a href="../options-html/my-bookings.html">
            <i class="ri-calendar-check-line"></i> My Bookings
          </a>
          <a href="../options-html/payment-history.html">
            <i class="ri-receipt-line"></i> Payment History
          </a>
          <a href="../options-html/notifications.html">
            <i class="ri-notification-3-line"></i> Notifications
          </a>
          <a href="../html/about.html">
            <i class="ri-information-2-line"></i> About
          </a>
          <a href="../html/contact.html">
            <i class="ri-mail-line"></i> Contact
          </a>
        </div>

        <div class="nav-links">
          <a href="../index.html">Home</a>
          <a href="about.html">About</a>
          <a href="services.html">Services</a>
          <a href="profile.html">Profile</a>
          <a href="contact.html" class="active">Contact</a>
        </div>
        <div class="auth-buttons">
          <a href="html/login.html" class="login-btn">Login</a>
          <a href="html/signup.html" class="signup-btn">Signup</a>
          <a
            href="#"
            id="logout-btn"
            class="logout-btn btn"
            style="display: none"
            >Logout</a
          >
        </div>
      </nav>
      <div class="menu-toggle" id="menu-toggle">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </header>

    <section class="contact-section">
      <div class="contact-container">
        <div class="contact-card">
          <div class="contact-image-container">
            <img
              src="../images/contact.jpg"
              alt="A person on the phone at a professional desk."
              class="contact-image"
            />
          </div>
          <div class="contact-form-container">
            <h2 class="form-title">Get in Touch</h2>
            <p class="form-subtitle">
              Have a question or need assistance? Fill out the form below, and
              we'll get back to you as soon as possible.
            </p>
            <form id="contactForm">
              <div class="form-group">
                <label for="name">Your Name</label>
                <input
                  type="text"
                  id="name"
                  name="name"
                  placeholder="Enter your name"
                  required
                />
              </div>
              <div class="form-group">
                <label for="email">Your Email</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  placeholder="Enter your email address"
                  required
                />
              </div>
              <div class="form-group">
                <label for="message">Your Message</label>
                <textarea
                  id="message"
                  name="message"
                  rows="5"
                  placeholder="Write your message here..."
                  required
                ></textarea>
              </div>
              <button type="submit" class="btn submit-btn">Send Message</button>
            </form>
          </div>
        </div>
      </div>
    </section>

    <div id="logout-popup" class="popup-container" style="display: none">
      <div class="popup-content">
        <p>Are you sure you want to log out?</p>
        <div class="popup-buttons">
          <button id="confirm-logout-btn" class="btn">Yes, Log Out</button>
          <button id="cancel-logout-btn" class="btn cancel-btn">
            No, Cancel
          </button>
        </div>
      </div>
    </div>

    <div class="modal-backdrop" id="successModalBackdrop">
      <div class="modal-content success-modal">
        <div class="modal-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <h3>Success!</h3>
        <p>
          Your message has been sent successfully. We will get back to you
          shortly.
        </p>
        <button class="modal-close-btn" onclick="closeSuccessPopup()">
          OK
        </button>
      </div>
    </div>

    <script type="module">
      // Add these lines at the top of your script to import Realtime Database functions
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
      import {
        getDatabase,
        ref,
        push,
        set,
      } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

      // ðŸ”¹ Firebase Config (signup page à¦à¦° à¦®à¦¤à§‹)
      const firebaseConfig = {
        apiKey: "AIzaSyCQneRn2fhr2MBPZ8FpGYQTHnSVXe-Y8oQ",
        authDomain: "electrofix-website.firebaseapp.com",
        projectId: "electrofix-website",
        storageBucket: "electrofix-website.appspot.com",
        messagingSenderId: "891241046906",
        appId: "1:891241046906:web:382d83e91f521a357cacc3",
        databaseURL:
          "https://electrofix-website-default-rtdb.asia-southeast1.firebasedatabase.app/",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);

      // Get the form and modal elements
      const contactForm = document.getElementById("contactForm");
      const successModalBackdrop = document.getElementById(
        "successModalBackdrop"
      );

      // Function to show the success popup
      function showSuccessPopup() {
        successModalBackdrop.classList.add("show");
      }

      // Function to close the success popup
      window.closeSuccessPopup = function () {
        successModalBackdrop.classList.remove("show");
      };

      // Contact Form Submit
      contactForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        const name = document.getElementById("name").value.trim();
        const email = document.getElementById("email").value.trim();
        const message = document.getElementById("message").value.trim();

        if (!name || !email || !message) {
          alert("Please fill all fields!");
          return;
        }

        try {
          // ðŸ”¹ Push new message
          const newMessageRef = push(ref(database, "contactMessages"));
          await set(newMessageRef, {
            name: name,
            email: email,
            message: message,
            timestamp: new Date().toISOString(),
          });

          // ðŸ”¹ Show the success popup instead of an alert
          showSuccessPopup();

          // Clear the form after a short delay
          setTimeout(() => {
            contactForm.reset();
          }, 100);
        } catch (error) {
          console.error("Error sending message:", error);
          alert("Error sending message: " + error.message);
        }
      });
    </script>

    <script type="module" src="../js/script.js"></script>
    <script src="../js/logout.js"></script>
  </body>
</html>
